#!/bin/bash

# å·¥æ™‚APP æ§‹å»ºè…³æœ¬
echo "ğŸš€ é–‹å§‹æ§‹å»ºå·¥æ™‚APP..."

# å®‰è£ä¾è³´é …
echo "ğŸ“¦ å®‰è£æ ¹ç›®éŒ„ä¾è³´é …..."
yarn install

echo "ğŸ“¦ å®‰è£ä¼ºæœå™¨ä¾è³´é …..."
cd server && yarn install && cd ..

echo "ğŸ“¦ å®‰è£å®¢æˆ¶ç«¯ä¾è³´é …..."
cd client && yarn install && cd ..

# æ§‹å»ºå®¢æˆ¶ç«¯
echo "ğŸ”¨ æ§‹å»ºå®¢æˆ¶ç«¯..."
cd client
yarn build
echo "âœ… å®¢æˆ¶ç«¯æ§‹å»ºå®Œæˆ"

# æª¢æŸ¥æ§‹å»ºçµæœ
echo "ğŸ” æª¢æŸ¥å®¢æˆ¶ç«¯æ§‹å»ºçµæœ..."
if [ ! -d "build" ]; then
    echo "âŒ å®¢æˆ¶ç«¯æ§‹å»ºå¤±æ•—ï¼šbuild ç›®éŒ„ä¸å­˜åœ¨"
    exit 1
fi

echo "ğŸ“‹ å®¢æˆ¶ç«¯æ§‹å»ºæª”æ¡ˆï¼š"
ls -la build/

# è¤‡è£½åˆ°ä¼ºæœå™¨ç›®éŒ„
echo "ğŸ“‹ è¤‡è£½æ§‹å»ºæª”æ¡ˆåˆ°ä¼ºæœå™¨ç›®éŒ„..."
cp -r build ../server/
cd ../server

echo "ğŸ” æª¢æŸ¥ä¼ºæœå™¨æ§‹å»ºæª”æ¡ˆ..."
if [ ! -d "build" ]; then
    echo "âŒ è¤‡è£½å¤±æ•—ï¼šserver/build ç›®éŒ„ä¸å­˜åœ¨"
    exit 1
fi

echo "ğŸ“‹ ä¼ºæœå™¨æ§‹å»ºæª”æ¡ˆï¼š"
ls -la build/

echo "âœ… æ§‹å»ºå®Œæˆï¼" 